import{d as v,a0 as y,Y as h,r as f,j as b,P as U,Q as k,V as a,U as t,a1 as C,c as E,X as R}from"./vue-aaa0e4fd.js";import{u as $,m as N}from"./index-39327448.js";import{b as S,f as V,N as q,h as B}from"./naive_ui-66407851.js";const K={class:"flex justify-center items-center mt-20"},x=v({__name:"index",setup(P){const p=y(),{t:i}=h(),r=$(),c=f(),o=b({username:"",password:""}),l=f(!1),_={username:{required:!0,message:i("tips.pleaseEnterUsername"),trigger:"blur"},password:{required:!0,message:i("tips.pleaseEnterPassword"),trigger:"blur"}},d=async()=>{var s;l.value||(s=c.value)==null||s.validate(e=>{e||(l.value=!0)}).then(async()=>{var e;try{await r.login(o);const{redirect:n,...u}=p.currentRoute.value.query;await r.fetchUserInfo(),N.success(i("tips.loginSuccess")),await p.push({name:(e=r.user)!=null&&e.is_superuser?"admin":"conversation"})}catch(n){console.log(n)}finally{l.value=!1}})};return r.user&&p.push({name:"conversation"}),(s,e)=>{const n=S,u=V,w=q,g=B;return U(),k("div",K,[a(g,{ref_key:"formRef",ref:c,model:o,rules:_,"label-col":{span:8},"wrapper-col":{span:16}},{default:t(()=>[a(u,{label:s.$t("commons.username"),path:"username"},{default:t(()=>[a(n,{value:o.username,"onUpdate:value":e[0]||(e[0]=m=>o.username=m),placeholder:s.$t("tips.pleaseEnterUsername"),"input-props":{autoComplete:"username"}},null,8,["value","placeholder"])]),_:1},8,["label"]),a(u,{label:s.$t("commons.password"),path:"password"},{default:t(()=>[a(n,{value:o.password,"onUpdate:value":e[1]||(e[1]=m=>o.password=m),type:"password","show-password-on":"click",placeholder:s.$t("tips.pleaseEnterPassword"),"input-props":{autoComplete:"current-password"},onKeyup:C(d,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["label"]),a(u,{"wrapper-col":"{ span: 16, offset: 8 }"},{default:t(()=>[a(w,{type:"primary",enabled:l.value,onClick:d},{default:t(()=>[E(R(s.$t("commons.login")),1)]),_:1},8,["enabled"])]),_:1})]),_:1},8,["model"])])}}});export{x as default};
//# sourceMappingURL=index-4e137e62.js.map
