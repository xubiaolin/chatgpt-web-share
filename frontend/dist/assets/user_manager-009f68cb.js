import{d as w,P as x,Q as A,R as y,e as S,S as z,U as u,V as s,G as n,Y as $,r as C,l as _,c as B,X as N}from"./vue-aaa0e4fd.js";import{n as L,u as R,j as h,o as D,q as P,c as T,r as F,m as g,s as V,t as j,v as q,w as G}from"./index-39327448.js";import{g as I,f as M,K as H,h as E,b as K,N as b,a as U,L as O}from"./naive_ui-66407851.js";import{T as Q}from"./TrashOutline-6dc727ad.js";import{R as W}from"./RefreshFilled-8fe6b2d2.js";const X={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Y=y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28L86.49 402.08L70 442l39.92-16.49l272.8-272.13l-24.1-24.1z"},null,-1),Z=y("path",{d:"M413.07 74.84l-11.79 11.78l24.1 24.1l11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44"},null,-1),J=[Y,Z],ee=w({name:"Pencil",render:function(t,m){return x(),A("svg",X,J)}}),te={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ae=y("path",{d:"M3 17h18c.55 0 1 .45 1 1s-.45 1-1 1H3c-.55 0-1-.45-1-1s.45-1 1-1zm-.5-4.43c.36.21.82.08 1.03-.28l.47-.82l.48.83c.21.36.67.48 1.03.28c.36-.21.48-.66.28-1.02l-.49-.84h.95c.41 0 .75-.34.75-.75s-.34-.75-.75-.75H5.3l.47-.82c.21-.36.09-.82-.27-1.03a.764.764 0 0 0-1.03.28L4 8.47l-.47-.82a.764.764 0 0 0-1.03-.28c-.36.21-.48.67-.27 1.03l.47.82h-.95c-.41 0-.75.34-.75.75s.34.75.75.75h.95l-.48.83c-.2.36-.08.82.28 1.02zm8 0c.36.21.82.08 1.03-.28l.47-.82l.48.83c.21.36.67.48 1.03.28c.36-.21.48-.66.28-1.02l-.48-.83h.95c.41 0 .75-.34.75-.75s-.34-.75-.75-.75h-.96l.47-.82a.76.76 0 0 0-.27-1.03a.746.746 0 0 0-1.02.27l-.48.82l-.47-.82a.742.742 0 0 0-1.02-.27c-.36.21-.48.67-.27 1.03l.47.82h-.96a.74.74 0 0 0-.75.74c0 .41.34.75.75.75h.95l-.48.83c-.2.36-.08.82.28 1.02zM23 9.97c0-.41-.34-.75-.75-.75h-.95l.47-.82a.76.76 0 0 0-.27-1.03a.746.746 0 0 0-1.02.27l-.48.83l-.47-.82a.742.742 0 0 0-1.02-.27c-.36.21-.48.67-.27 1.03l.47.82h-.95a.743.743 0 0 0-.76.74c0 .41.34.75.75.75h.95l-.48.83a.74.74 0 0 0 .28 1.02c.36.21.82.08 1.03-.28l.47-.82l.48.83c.21.36.67.48 1.03.28c.36-.21.48-.66.28-1.02l-.48-.83h.95c.4-.01.74-.35.74-.76z",fill:"currentColor"},null,-1),ne=[ae],se=w({name:"PasswordRound",render:function(t,m){return x(),A("svg",te,ne)}}),le=w({__name:"EditLimitForm",props:{limit:null},emits:["update:limit"],setup(k,{emit:t}){const m=k,r=L.global.t,l=S({get:()=>m.limit,set:e=>{t("update:limit",e)}}),f=e=>e==-1?r("commons.unlimited"):e,p=e=>e==r("commons.unlimited")?-1:parseInt(e);return(e,a)=>{const i=I,c=M,o=H,v=E;return x(),z(v,{"label-placement":"left","label-width":"auto",style:{maxWidth:"640px"}},{default:u(()=>[s(c,{label:n(r)("commons.canUsePaidModel"),path:"can_use_paid"},{default:u(()=>[s(i,{value:n(l).can_use_paid,"onUpdate:value":a[0]||(a[0]=d=>n(l).can_use_paid=d),placeholder:""},null,8,["value"])]),_:1},8,["label"]),s(c,{label:n(r)("commons.canUseGPT4Model"),path:"can_use_paid"},{default:u(()=>[s(i,{value:n(l).can_use_gpt4,"onUpdate:value":a[1]||(a[1]=d=>n(l).can_use_gpt4=d),placeholder:""},null,8,["value"])]),_:1},8,["label"]),s(c,{label:n(r)("commons.maxConversationCount"),path:"max_conv_count"},{default:u(()=>[s(o,{value:n(l).max_conv_count,"onUpdate:value":a[2]||(a[2]=d=>n(l).max_conv_count=d),parse:p,format:f},null,8,["value"])]),_:1},8,["label"]),s(c,{label:n(r)("commons.availableAskCount"),path:"available_ask_count"},{default:u(()=>[s(o,{value:n(l).available_ask_count,"onUpdate:value":a[3]||(a[3]=d=>n(l).available_ask_count=d),parse:p,format:f},null,8,["value"])]),_:1},8,["label"]),s(c,{label:n(r)("commons.availableGPT4AskCount"),path:"available_gpt4_ask_count"},{default:u(()=>[s(o,{value:n(l).available_gpt4_ask_count,"onUpdate:value":a[4]||(a[4]=d=>n(l).available_gpt4_ask_count=d),parse:p,format:f},null,8,["value"])]),_:1},8,["label"])]),_:1})}}}),oe=w({__name:"EditUserForm",props:{user:null},emits:["update:user"],setup(k,{emit:t}){const m=k,r=L.global.t,l=S({get:()=>m.user,set:p=>{t("update:user",p)}}),f={username:{required:!0,message:r("tips.pleaseEnterUsername"),trigger:"blur"},password:{required:!0,message:r("tips.pleaseEnterPassword"),trigger:"blur"},email:{required:!0,message:r("tips.pleaseEnterEmail"),trigger:"blur"},nickname:{required:!0,message:r("tips.pleaseEnterNickname"),trigger:"blur"}};return(p,e)=>{const a=K,i=M,c=E;return x(),z(c,{ref:"formRef",model:m.user,rules:f,"label-col":{span:8},"wrapper-col":{span:16}},{default:u(()=>[s(i,{label:n(r)("commons.username"),path:"username"},{default:u(()=>[s(a,{value:n(l).username,"onUpdate:value":e[0]||(e[0]=o=>n(l).username=o),placeholder:""},null,8,["value"])]),_:1},8,["label"]),s(i,{label:n(r)("commons.nickname"),path:"nickname"},{default:u(()=>[s(a,{value:n(l).nickname,"onUpdate:value":e[1]||(e[1]=o=>n(l).nickname=o),placeholder:""},null,8,["value"])]),_:1},8,["label"]),s(i,{label:n(r)("commons.password"),path:"password"},{default:u(()=>[s(a,{value:n(l).password,"onUpdate:value":e[2]||(e[2]=o=>n(l).password=o),placeholder:""},null,8,["value"])]),_:1},8,["label"]),s(i,{label:n(r)("commons.email"),path:"email"},{default:u(()=>[s(a,{value:n(l).email,"onUpdate:value":e[3]||(e[3]=o=>n(l).email=o),placeholder:""},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),re={class:"mb-4 mt-1 ml-1 flex flex-row space-x-2 justify-between"},de=w({__name:"user_manager",setup(k){const{t}=$();R();const m=C([]),r=()=>{h().then(e=>{m.value=e.data})};h().then(e=>{m.value=e.data});const l=[{title:"#",key:"id"},{title:t("commons.username"),key:"username"},{title:t("commons.nickname"),key:"nickname"},{title:t("commons.status"),key:"chat_status",render(e){return e.chat_status?t(D[e.chat_status]):""},sorter:"default"},{title:t("commons.activeTime"),key:"active_time",render(e){return e.active_time?new Date(e.active_time+"Z").toLocaleString():t("commons.neverActive")},sorter:(e,a)=>!e.active_time||!a.active_time?0:new Date(e.active_time).getTime()-new Date(a.active_time).getTime()},{title:t("commons.maxConversationCount"),key:"max_conv_count",render(e){return P(e.max_conv_count)}},{title:t("commons.availableAskCount"),key:"available_ask_count",render(e){return P(e.available_ask_count)}},{title:t("commons.availableGPT4AskCount"),key:"available_gpt4_ask_count",render(e){return P(e.available_gpt4_ask_count)}},{title:t("commons.canUsePaidModel"),key:"can_use_paid",render(e){return e.can_use_paid?t("commons.yes"):t("commons.no")}},{title:t("commons.canUseGPT4Model"),key:"can_use_gpt4",render(e){return e.can_use_gpt4?t("commons.yes"):t("commons.no")}},{title:t("commons.email"),key:"email"},{title:t("commons.isSuperuser"),key:"is_superuser",render(e){return e.is_superuser?t("commons.yes"):t("commons.no")}},{title:t("commons.actions"),key:"actions",fixed:"right",render(e){return _("div",{class:"flex justify-start space-x-2"},[_(b,{size:"small",type:"error",circle:!0,secondary:!0,onClick:()=>{const a=T.warning({title:t("commons.deleteUser"),content:t("tips.deleteUserConfirm"),positiveText:t("commons.confirm"),negativeText:t("commons.cancel"),onPositiveClick:()=>(a.loading=!0,new Promise((i,c)=>{F(e.id).then(o=>{g.success(t("tips.deleteUserSuccess")),h().then(v=>{m.value=v.data}),i(!0)}).catch(o=>{g.error(t("tips.deleteUserFailed")+": "+o),c(o)}).finally(()=>{a.loading=!1})}))})}},{icon:()=>_(U,null,{default:()=>_(Q)})}),_(b,{size:"small",type:"info",circle:!0,secondary:!0,onClick:()=>{V(async a=>{await G(e.id,a)},()=>{g.info(t("tips.resetUserPasswordSuccess"))},()=>{g.error(t("tips.resetUserPasswordFailed"))})}},{icon:()=>_(U,null,{default:()=>_(se)})}),_(b,{size:"small",type:"primary",circle:!0,secondary:!0,onClick:p(e)},{icon:()=>_(U,null,{default:()=>_(ee)})})])}}],f=()=>{const e=C({username:"",nickname:"",email:"",password:"",is_superuser:!1}),a=T.info({title:t("commons.addUser"),content:()=>_(oe,{user:e.value,"onUpdate:user":i=>{e.value=i}},{default:()=>""}),positiveText:t("commons.confirm"),negativeText:t("commons.cancel"),onPositiveClick:()=>(a.loading=!0,new Promise((i,c)=>{q(e.value).then(o=>{g.success(t("commons.addUserSuccess")),h().then(v=>{m.value=v.data}),i(!0)}).catch(o=>{g.error(t("commons.addUserFailed")+": "+o),c(o)}).finally(()=>{a.loading=!1})}))})},p=e=>()=>{const a=C({max_conv_count:e.max_conv_count,available_ask_count:e.available_ask_count,can_use_paid:e.can_use_paid,can_use_gpt4:e.can_use_gpt4,available_gpt4_ask_count:e.available_gpt4_ask_count}),i=T.info({title:t("commons.setUserLimit"),content:()=>_(le,{limit:a.value,"onUpdate:limit":c=>{a.value=c}},{default:()=>""}),positiveText:t("commons.confirm"),negativeText:t("commons.cancel"),onPositiveClick:()=>(i.loading=!0,new Promise((c,o)=>{j(e.id,a.value).then(v=>{g.success(t("commons.setUserLimitSuccess")),h().then(d=>{m.value=d.data}),c(!0)}).catch(v=>{o(v)}).finally(()=>{i.loading=!1})}))})};return(e,a)=>{const i=O;return x(),A("div",null,[y("div",re,[s(n(b),{circle:"",onClick:r},{icon:u(()=>[s(n(U),null,{default:u(()=>[s(n(W))]),_:1})]),_:1}),s(n(b),{type:"primary",onClick:f},{default:u(()=>[B(N(e.$t("commons.addUser")),1)]),_:1})]),s(i,{"scroll-x":1400,size:"small",columns:l,data:m.value,bordered:!0,pagination:{pageSize:20}},null,8,["data"])])}}});export{de as default};
//# sourceMappingURL=user_manager-009f68cb.js.map
